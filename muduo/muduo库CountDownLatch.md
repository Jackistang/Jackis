# muduo 库 CountDownLatch

CountDownLatch是一个同步工具类，它允许一个或多个线程一直等待，直到其他线程执行完后再执行。

## 使用场景

1. 实现最大的并行性：有时我们想同时启动多个线程，实现最大程度的并行性。例如，我们想测试一个单例类。如果我们创建一个初始计数器为1的CountDownLatch，并让其他所有线程都在这个锁上等待，只需要调用一次countDown()方法就可以让其他所有等待的线程同时恢复执行。
2. 开始执行前等待N个线程完成各自任务：例如应用程序启动类要确保在处理用户请求前，所有N个外部系统都已经启动和运行了。
3. 死锁检测：一个非常方便的使用场景是你用N个线程去访问共享资源，在每个测试阶段线程数量不同，并尝试产生死锁。

参考：[https://www.jianshu.com/p/4b6fbdf5a08f](https://www.jianshu.com/p/4b6fbdf5a08f)

## muduo 库 CountDownLatch 使用

CountDownLatch 的构造函数初始化了内部的计数值 count_ 。当线程调用其 `wait()` 函数时，若计数值 count_ 仍大于 0 ，则该线程阻塞在此处。此时若有其他线程调用 `countDown()` 函数将计数值减为 0 ，则会唤醒所有阻塞在 `wait()` 函数处的线程。

